{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8481d02c-8fc3-49f0-9b86-84941b78c8f6",
   "metadata": {},
   "source": [
    "$$\n",
    "\\text{Midterm Take-Home Exam}\n",
    "$$\n",
    "$$\n",
    "\\text{December 20, 2024 (DUE January 10, 2025)}\n",
    "$$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0503fdd5-3201-4f1b-8c90-67e971a6dd00",
   "metadata": {},
   "source": [
    "$$\n",
    "\\text{Instructions}\n",
    "$$\n",
    "\n",
    "- Open book and open class notes are allowed (including notes taken by students during exam). No other notes are allowed.\n",
    "  \n",
    "- Each answer should be clearly written, and the solution should be developed in detail.\n",
    "  \n",
    "- Mathematical derivations need to show all steps that lead to the answer.\n",
    "  \n",
    "- Partial credit will be given for incomplete solutions.\n",
    "  \n",
    "- There is NO penalty for incorrect solutions."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "565d23fe-4016-4b4c-9a8f-0689ffea3530",
   "metadata": {},
   "source": [
    "$$\n",
    "\\text{Hints - equations - conventions:}\n",
    "$$\n",
    "\n",
    "- Notation\n",
    "\n",
    "    - $R$ represents the rate of communication in bits per channel use (bpcu),\n",
    "      \n",
    "    - $\\rho$ represents the SNR (signal to noise ratio),\n",
    "      \n",
    "    - $w$ will denote additive noise which will be distributed as a circularly symmetric Gaussian random variable $\\mathbb{C}\\mathcal{N}(0,N_0)$. If $N_0$ is not specified, then set $N_0 = 1$,\n",
    "      \n",
    "    - Remember: for a given signal-to-noise ratio (SNR), then SNR in dB is simply $10 log_{10} SNR$\n",
    "      \n",
    "    - SISO stands for single-input single-output, MISO stands for multiple-input single output, SIMO stands for single-input multiple output, MIMO stands for multiple input multiple output.\n",
    "      \n",
    "    - MU stands for multi-user.\n",
    "      \n",
    "    - CSIT stands for channel state information at the transmitter, while CSIR stands for channel state information at the receiver.\n",
    "      \n",
    "    - AWGN stands for additive white Gaussian noise.\n",
    "\n",
    "- GOOD LUCK!!"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "617987ba-f352-4ece-b078-f19d29eed2c0",
   "metadata": {},
   "source": [
    "$$\\text{EXAM PROBLEMS}$$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a1bd6f3a-c5f8-4bc0-a014-0f5af6df1bc0",
   "metadata": {},
   "source": [
    "$\\color{orange}1\\Bigl)$ ___(1 point)___. Consider a SISO setting, with no fading. Consider that the maximum possible rate (i.e., the capacity) is equal to 7 bpcu. What is the minimum SNR required to achieve this rate? Do you need CSIR?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1e498571-f221-4c9d-b8a7-9157a8365886",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "To determine the minimum SNR required to achieve a rate of 7 bpcu (bits per channel use), we use the **Shannon capacity formula** for a single-input single-output (SISO) channel with no fading:\n",
    "\n",
    "$C = \\log_2(1 + \\text{SNR}),$\n",
    "\n",
    "where:\n",
    "- $C$ is the channel capacity in bits per channel use (bpcu),\n",
    "- $\\text{SNR}$ is the signal-to-noise ratio (linear scale).\n",
    "\n",
    "#### Step 1: Solve for SNR\n",
    "Given that $C = 7$, we solve for $\\text{SNR}$:\n",
    "$7 = \\log_2(1 + \\text{SNR}).$\n",
    "\n",
    "Convert to base-10 logarithms for clarity:\n",
    "$1 + \\text{SNR} = 2^7.$\n",
    "\n",
    "Simplify:\n",
    "$1 + \\text{SNR} = 128.$\n",
    "\n",
    "$\\text{SNR} = 128 - 1 = 127.$\n",
    "\n",
    "#### Step 2: Minimum SNR\n",
    "The minimum **SNR** required is:\n",
    "$\\text{SNR (linear)} = 127.$\n",
    "\n",
    "Convert to decibels (dB):\n",
    "$\\text{SNR (dB)} = 10 \\cdot \\log_{10}(127).$\n",
    "\n",
    "Using a calculator:\n",
    "$\\text{SNR (dB)} \\approx 21.03 \\, \\text{dB}.$\n",
    "\n",
    "#### Step 3: Do You Need CSIR?\n",
    "- **CSIR (Channel State Information at the Receiver)**: Yes, CSIR is needed to decode the signal efficiently. Without CSIR, the receiver cannot effectively interpret the transmitted data, even in a SISO setting with no fading.\n",
    "- **CSIT (Channel State Information at the Transmitter)**: CSIT is not needed in this scenario because there is no fading, so the channel is constant, and the transmitter does not need to adapt its strategy dynamically.\n",
    "\n",
    "#### Final Answer:\n",
    "- **Minimum SNR (linear)**: $127$,\n",
    "- **Minimum SNR (dB)**: $21.03 \\, \\text{dB}$,\n",
    "- **CSIR Requirement**: Yes, CSIR is required."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7e2331bc-51b8-47b5-ab8c-00ed450ad5dc",
   "metadata": {},
   "source": [
    "$\\color{orange}2\\Bigl)$ ___(1 point)___. Consider a SISO quasi-static fading channel with no CSIT. We wish to decrease the probability of error, from$P_{err} \\approx (SNR)^{−1}$ to $P_{err} \\approx (SNR)^{−4}$. Suggest various ways we can achieve this, based on what we have learned in class."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0627db3e-0197-4163-992a-9717c039c3fa",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "Ways to Improve from $P_{err} \\approx (SNR)^{−1}$to$P_{err} \\approx (SNR)^{−4}$:\n",
    "\n",
    "1. Error-Correcting Codes:\n",
    "- Use stronger codes (e.g., LDPC, Turbo, Polar codes).\n",
    "- Increase codeword length.\n",
    "\n",
    "2.\tDiversity Techniques:\n",
    "- Time Diversity: Retransmissions (e.g., hybrid ARQ).\n",
    "- Frequency Diversity: Spread spectrum or OFDM.\n",
    "- Antenna Diversity: Space-time coding (e.g., Alamouti).\n",
    "\n",
    "3.\tModulation:\n",
    "- Use lower-order modulation (e.g., QPSK instead of 16-QAM).\n",
    "- Apply trellis-coded modulation (TCM).\n",
    "\n",
    "4.\tSignal Design:\n",
    "- Use constellation shaping for better noise robustness.\n",
    "\n",
    "5.\tImproved CSIR:\n",
    "- Enhance channel estimation at the receiver for better decoding.\n",
    "\n",
    "6.\tAdaptive Techniques:\n",
    "- SNR-adaptive decoding or statistical power allocation.\n",
    "\n",
    "By combining coding, diversity, and modulation optimization, the desired reduction  $P_{err}$ can be achieved."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8618e9cc-c1c9-4ad7-86ef-9cba2d762034",
   "metadata": {},
   "source": [
    "$\\color{orange}3\\Bigl)$ ___(1 point)___. What are some of the advantages of MISO vs. SIMO, mentioned in class?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ee9183c-44bf-4cfb-83ee-cb0aee886c0d",
   "metadata": {},
   "source": [
    "---\n",
    "MISO (Multiple Input Single Output) has several advantages over SIMO (Single Input Multiple Output):\n",
    "\n",
    "1. **Improved Signal Reliability**: Multiple antennas at the transmitter reduce the impact of fading.\n",
    "2. **Enhanced Data Rates**: Multiple transmitting antennas can increase data rates.\n",
    "3. **Diversity Gain**: Provides diversity gain to combat multi-path fading.\n",
    "4. **Power Efficiency**: Distributes transmission power across multiple antennas, improving efficiency."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "475255b6-cdf3-4334-ae56-581075c35c9f",
   "metadata": {},
   "source": [
    "$\\color{orange}4\\Bigl)$ ___(1 point)___. In a single-user MIMO channel, how much diversity gain would we be able to get if we employed a transmitter with 4 transmit antennas and a receiver with 2 receive antennas, when in fact the channel between the first transmit and receive antenna, is identical always to the channel between the first transmit and second receive antenna?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7546bde2-7d04-49a4-b5b7-9517892138cd",
   "metadata": {},
   "source": [
    "---\n",
    "With 4 transmit antennas and 2 receive antennas, if the channel between the first transmit antenna and both receive antennas is identical, the effective diversity gain is calculated as follows:\n",
    "\n",
    "$\\text{Diversity Gain} = N_t \\times N_{\\text{effective}} = 4 \\times 1 = 4$\n",
    "\n",
    "Thus, the diversity gain would be 4."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a4ee06ee-1d36-438e-ba18-bda771898931",
   "metadata": {},
   "source": [
    "$\\color{orange}5\\Bigl)$ ___(1 point)___. In a single-user MISO channel, how much multiplexing gain would we be able to get if we employed a transmitter with 2 transmit antennas?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6f03f7ea-6790-4748-b54e-23531a87269c",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "In a single-user MISO channel with 2 transmit antennas, the multiplexing gain is:\n",
    "\n",
    "$\\text{Multiplexing Gain} = \\min(N_t, 1) = \\min(2, 1) = 1$\n",
    "\n",
    "Given:\n",
    "- $N_t = 2$ (number of transmit antennas)\n",
    "- Receive antennas = 1\n",
    "\n",
    "Thus, the multiplexing gain is 1."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c9a22d0-9e1b-4fe0-bd8e-f96cb97017a2",
   "metadata": {},
   "source": [
    "$\\color{orange}6\\Bigl)$ ___(1 points)___. Consider communication over a quasi-static $2 \\times 1$ MISO fading channel. Assume that you must draw symbols from 16-QAM.\n",
    "\n",
    "- Can you name a space time code, that gives full diversity in this setting, and then describe the rate (in bpcu) of such a code."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7d83a024-2dfc-492a-a1dd-1d262c6bc65e",
   "metadata": {},
   "source": [
    "---\n",
    "For a quasi-static $2 \\times 1$ MISO (Multiple Input Single Output) fading channel, a well-known space-time code that provides full diversity is the Alamouti code. The Alamouti scheme is specifically designed for a $2 \\times 1$ setup and achieves full diversity by using two transmit antennas and one receive antenna.\n",
    "\n",
    "### Space-Time Code: Alamouti Code\n",
    "- **Diversity Gain**: Full diversity\n",
    "- **Code Rate**: 1 bpcu (bit per channel use)\n",
    "\n",
    "### Description\n",
    "The Alamouti scheme transmits two symbols $s_1$ and $s_2$ over two time slots from two transmit antennas. The transmission matrix for the Alamouti code is given by:\n",
    "\n",
    "$\\mathbf{S} = \\begin{bmatrix} s_1 & s_2 \\\\ -s_2^* & s_1^* \\end{bmatrix}$\n",
    "\n",
    "### Rate Calculation\n",
    "Since 16-QAM is used, each symbol $s_1$ and $s_2$ carries 4 bits (since 16-QAM has $2^4 = 16$ symbols).\n",
    "\n",
    "- In one time slot, 4 bits are transmitted from each antenna.\n",
    "- Over two time slots, a total of 8 bits are transmitted.\n",
    "\n",
    "Since the rate of the Alamouti code is 1 bpcu, and we use 16-QAM, the effective rate of the system is:\n",
    "\n",
    "$\\text{Rate} = \\frac{\\text{Number of bits transmitted}}{\\text{Number of channel uses}} = \\frac{8 \\text{ bits}}{2 \\text{ channel uses}} = 4 \\text{ bits per channel use (bpcu)}$\n",
    "\n",
    "Thus, the Alamouti code provides full diversity with a rate of 4 bpcu when using 16-QAM."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "10d58861-26e0-4abd-b75b-4ad56c88f220",
   "metadata": {},
   "source": [
    "$\\color{orange}7\\Bigl)$ ___(3 points)___. In the context of various strategies, answer if each of the following statements are true or false, justifying briefly your answers.\n",
    "\n",
    "- In a MISO channel, we can get transmitter beamforming gain even without CSIT.\n",
    "\n",
    "    - **False** - Transmitter beamforming gain requires CSIT.\n",
    "\n",
    "- A base station equipped with 5 antennas in the downlink, can simultaneously serve up to 5 users (single receive antenna each).\n",
    "\n",
    "    - **True** - 5 antennas can serve 5 users with single antennas using spatial multiplexing.\n",
    "\n",
    "- A base station equipped with 5 antennas in the downlink, can simultaneously serve up to 10 users (two receive antennas each).\n",
    "\n",
    "    - **False** - 5 antennas cannot serve 10 users even if each user has 2 receive antennas.\n",
    "  \n",
    "- A base station equipped with 4 antennas in the downlink, can simultaneously serve up to 2 users (two receive antennas each).\n",
    "\n",
    "    - **True** - 4 antennas can serve 2 users with 2 receive antennas each using spatial multiplexing.\n",
    "\n",
    "- Line of sight channels are detrimental for spatial multiplexing in both single-user and multiuser MIMO.\n",
    "\n",
    "    - **True** - Line of sight channels are detrimental for spatial multiplexing due to rank deficiency.\n",
    "\n",
    "- For a MIMO receiver using spatial multiplexing, the complexity of ZF receiver is more than the complexity of the maximum-likelihood receiver.\n",
    "\n",
    "    - **False** - ZF receiver is less complex than the maximum-likelihood receiver.\n",
    "\n",
    "- CSIT is easier to obtain than CSIR.\n",
    "\n",
    "    - **False** - CSIR is generally easier to obtain than CSIT.\n",
    "\n",
    "- CSIT is of cardinal importance in multi-user MIMO.\n",
    "\n",
    "    - **True** - CSIT is crucial for multi-user MIMO to perform efficient beamforming and spatial multiplexing.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "efd51e91-2bcc-4eb1-b0b0-019a322dacb4",
   "metadata": {},
   "source": [
    "$\\color{orange}8\\Bigl)$ ___(2 points)___. In a MU-MIMO channel, if I double the number of users I simultaneously serve, must I always halve the individual rate to each user? Justify your answer."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3bfa6716-cf06-4b93-aa1a-bdf8e267ba49",
   "metadata": {},
   "source": [
    "---\n",
    "No, you do not always have to halve the individual rate when doubling the number of users in a MU-MIMO channel. Efficient spatial multiplexing, power allocation, favorable channel conditions, and advanced techniques can maintain or even improve individual rates despite an increase in the number of users."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "76332a60-6800-4414-9b33-bc983919df2e",
   "metadata": {},
   "source": [
    "$\\color{orange}9\\Bigl)$ ___(4 points)___. Consider communication over the$2 \\times 1$ quasi-static fading MISO channel, using a diagonal\n",
    "code (see below for details) such that the channel model is given by\n",
    "\n",
    "$$\n",
    "\\overbrace{(y_1 \\quad y_2)}^{\\underline{y}} = \\theta \\; \\overbrace{(h_1 \\quad h_2)}^{\\underline{h}} \\overbrace{\\Bigl(\\begin{matrix} x_1&0 \\\\ 0&x_2 \\end{matrix} \\Bigr)}^{\\mathcal{X}_{tr}} + \\overbrace{(w_1 \\quad w_2)}^{\\underline{w}}\n",
    "$$\n",
    "\n",
    "where $h_i \\sim \\mathbb{C}N(0,1)$ and $w_i \\sim \\mathbb{C}N(0,1)$ , and where $\\theta$ is the power normalization factor that lets you regulate SNR.\n",
    "\n",
    "- Describe the ML decoding rule for this case.\n",
    "- Describe the $\\text{cardinality}^1$ of code $\\mathcal{X}_{tr}$ if you wish a rate of $R = 4$ bpcu.\n",
    "- For a desired rate of $R = 8$ bpcu, and a desired SNR = 10 dB (where by SNR we mean the AVERAGE signal power divided by the noise unit power, under QAM) then what is the normalizing factor $\\theta$ ?\n",
    "- Imagine that what you transmit $(x_1,x_2)$ are independently chosen from 16-PAM, then\n",
    "    - What is the rate of your code (in bpcu)?\n",
    "    - What is the slope of your probability of error, in high SNR, if you plot on the y-axis the probability of error, in log scale ($\\log_{10}(\\text{Prob})$), and the x-axis is the SNR, in dB?\n",
    "- Imagine now that $( x_1 x_2 ) = s_1 s_2 \\cdot \\mathbf{Q}$, where s1,s2 are independently chosen from a 64-QAM constellation, where the matrix $\\mathbf{Q}$ is a randomly chosen orthogonal matrix. Then\n",
    "    - What is the rate of your code?   \n",
    "    - What is the aforementioned slope of your probability of error?\n",
    " \n",
    "$^1$ By cardinality we mean the number of matrices that the code has."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3082cc80-7cda-4cd2-bffc-10cf83f3f480",
   "metadata": {},
   "source": [
    "---\n",
    "### ML Decoding Rule\n",
    "The Maximum Likelihood (ML) decoding rule for the given channel model is to find the transmitted symbols $x_1$ and $x_2$ that minimize the Euclidean distance between the received vector $\\underline{y}$ and the expected received vector given by the channel matrix $\\underline{h}$ and the transmitted symbols. Mathematically, this can be expressed as:\n",
    "\n",
    "$\\hat{x}_1, \\hat{x}_2 = \\arg\\min_{x_1, x_2} \\| \\underline{y} - \\theta \\underline{h} \\mathcal{X}_{tr} \\|^2$\n",
    "\n",
    "where $\\underline{y} = (y_1 \\quad y_2)$, $\\underline{h} = (h_1 \\quad h_2)$, $\\mathcal{X}_{tr} = \\begin{pmatrix} x_1 & 0 \\\\ 0 & x_2 \\end{pmatrix}$.\n",
    "\n",
    "### Cardinality of Code $\\mathcal{X}_{tr}$ for Rate $R = 4$ bpcu\n",
    "The rate $R$ in bits per channel use (bpcu) determines the number of possible codewords. If $R = 4$ bpcu, the number of codewords is $2^R = 2^4 = 16$. Therefore, the cardinality of the code $\\mathcal{X}_{tr}$ is 16.\n",
    "\n",
    "### Normalizing Factor $\\theta$ for Rate $R = 8$ bpcu at SNR = 10 dB\n",
    "For an SNR of 10 dB, the average signal power to noise power ratio is 10. In terms of linear scale, this is $10^{10/10} = 10$.\n",
    "\n",
    "Given that we are using QAM, the average power of a QAM signal is proportional to the square of the constellation size. For a rate of $R = 8$ bpcu, we need $2^8 = 256$ possible symbols. This corresponds to a 256-QAM constellation.\n",
    "\n",
    "The normalizing factor $\\theta$ ensures that the average signal power is regulated to achieve the desired SNR. The power normalization factor can be calculated as:\n",
    "\n",
    "$\\theta = \\sqrt{\\frac{\\text{SNR}}{\\text{Average Power of QAM constellation}}}$\n",
    "\n",
    "For 256-QAM, the average power is approximately:\n",
    "\n",
    "$P_{\\text{avg}} = \\frac{(M-1)}{3} = \\frac{255}{3} \\approx 85$\n",
    "\n",
    "Thus,\n",
    "\n",
    "$\\theta = \\sqrt{\\frac{10}{85}} \\approx 0.34$\n",
    "\n",
    "### Rate of Code and Slope of Probability of Error for 16-PAM\n",
    "- **Rate**: If $x_1$ and $x_2$ are independently chosen from a 16-PAM constellation, each symbol carries $\\log_2(16) = 4$ bits. Since there are 2 symbols, the rate is:\n",
    "\n",
    "$R = 2 \\times 4 = 8 \\text{ bpcu}$\n",
    "\n",
    "- **Slope of Probability of Error**: In high SNR regimes, the slope of the probability of error (in log scale) for a system with diversity order $d$ is:\n",
    "\n",
    "$\\text{Slope} = -d$\n",
    "\n",
    "For a 2x1 MISO system using independent symbols, the diversity order is 2. Thus, the slope of the probability of error is:\n",
    "\n",
    "$\\text{Slope} = -2$\n",
    "\n",
    "### Rate and Slope of Probability of Error for Orthogonal Matrix $\\mathbf{Q}$ with 64-QAM\n",
    "- **Rate**: If $x_1$ and $x_2$ are chosen from a 64-QAM constellation, each symbol carries $\\log_2(64) = 6$ bits. Since there are 2 symbols, the rate is:\n",
    "\n",
    "$R = 2 \\times 6 = 12 \\text{ bpcu}$\n",
    "\n",
    "- **Slope of Probability of Error**: If $(x_1, x_2) = (s_1, s_2) \\cdot \\mathbf{Q}$ where $\\mathbf{Q}$ is an orthogonal matrix, the diversity order remains 2. Therefore, the slope of the probability of error is:\n",
    "\n",
    "$\\text{Slope} = -2$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c4a5f15-0a4d-44d0-93b9-60ce4ddb392a",
   "metadata": {},
   "source": [
    "$\\color{orange}10\\Bigl)$ ___(Extra Credit: 5 points)___. Consider communication over a quasi-static$2 \\times 2$MIMO channel, utilizing the space-time code$\\mathcal{X} = \\{\\mathbf{X}_1,\\mathbf{X}_2,\\mathbf{X}_3,\\mathbf{X}_4\\}$, where\n",
    "\n",
    "$$\n",
    "\\mathbf{X}_1 =\n",
    "\\begin{bmatrix}\n",
    "  1 & -1 \\\\\n",
    "  1 & 1\n",
    "\\end{bmatrix},\n",
    "\\mathbf{X}_2 =\n",
    "\\begin{bmatrix}\n",
    "  1 & 1 \\\\\n",
    "  -1 & 1\n",
    "\\end{bmatrix},\n",
    "\\mathbf{X}_3 =\n",
    "\\begin{bmatrix}\n",
    "  -1 & -1 \\\\\n",
    "  1 & -1\n",
    "\\end{bmatrix}\n",
    "\\text{and} \\,\n",
    "\\mathbf{X}_4 =\n",
    "\\begin{bmatrix}\n",
    "  -1 & 1 \\\\\n",
    "  -1 & -1\n",
    "\\end{bmatrix},\n",
    "$$\n",
    "\n",
    "- What is the average SNR?\n",
    "- What is the rate of the code in bpcu?\n",
    "- What is the diversity gain of this code?\n",
    "- What is the approximate (in the high SNR regime) probability of error of this code, if SNR is 30dB?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "81b993db-e33c-4594-97f6-44a2f33525e7",
   "metadata": {},
   "source": [
    "---\n",
    "### Average SNR\n",
    "The SNR (Signal-to-Noise Ratio) in a MIMO system is typically defined as the ratio of the average signal power to the average noise power. If we assume the transmitted signal power is normalized to 1, and the noise power is also normalized to 1 (i.e., unit variance noise), then the average SNR is given directly by the power normalization factor.\n",
    "\n",
    "Given that the SNR is often defined per receive antenna, and assuming equal power allocation across the transmit antennas, the average SNR per receive antenna is:\n",
    "\n",
    "$\n",
    "\\text{SNR} = \\frac{\\text{Total transmit power}}{\\text{Noise power per receive antenna}}\n",
    "$\n",
    "\n",
    "In this case, we assume the transmit power is 1 per antenna and the noise power is 1 per receive antenna, so:\n",
    "\n",
    "$\n",
    "\\text{Average SNR} = \\text{SNR} = \\frac{1}{1} = 1 \\text{ (normalized)}\n",
    "$\n",
    "\n",
    "### Rate of the Code in bpcu\n",
    "The rate of a space-time code is determined by the number of independent symbols transmitted per channel use. Here, we have 4 code matrices $\\mathcal{X} = \\{\\mathbf{X}_1, \\mathbf{X}_2, \\mathbf{X}_3, \\mathbf{X}_4\\}$.\n",
    "\n",
    "Each code matrix represents a unique codeword. Since there are 4 codewords, we can send $\\log_2(4) = 2$ bits per channel use (bpcu).\n",
    "\n",
    "$\n",
    "\\text{Rate} = 2 \\text{ bpcu}\n",
    "$\n",
    "\n",
    "### Diversity Gain of the Code\n",
    "The diversity gain of a space-time code is given by the rank of the difference of any two distinct code matrices. For full diversity, the rank of all such differences should be equal to the number of transmit antennas.\n",
    "\n",
    "Let's check the rank of the difference of any two distinct code matrices. For example, consider $\\mathbf{X}_1$ and $\\mathbf{X}_2$:\n",
    "\n",
    "$\n",
    "\\mathbf{X}_1 - \\mathbf{X}_2 =\n",
    "\\begin{bmatrix}\n",
    "1 & -1 \\\\\n",
    "1 & 1\n",
    "\\end{bmatrix}\n",
    "-\n",
    "\\begin{bmatrix}\n",
    "1 & 1 \\\\\n",
    "-1 & 1\n",
    "\\end{bmatrix}\n",
    "=\n",
    "\\begin{bmatrix}\n",
    "0 & -2 \\\\\n",
    "2 & 0\n",
    "\\end{bmatrix}\n",
    "$\n",
    "\n",
    "The rank of this matrix is 2, indicating full diversity.\n",
    "\n",
    "$\n",
    "\\text{Diversity Gain} = 2\n",
    "$\n",
    "\n",
    "### Approximate Probability of Error at SNR = 30 dB\n",
    "In the high SNR regime, the probability of error $P_e$ for a MIMO system with diversity gain $d$ typically decreases as:\n",
    "\n",
    "$\n",
    "P_e \\approx \\left( \\frac{1}{\\text{SNR}} \\right)^d\n",
    "$\n",
    "\n",
    "Given:\n",
    "- SNR = 30 dB = $10^{30/10} = 10^3$\n",
    "- Diversity Gain $d = 2$\n",
    "\n",
    "The approximate probability of error is:\n",
    "\n",
    "$\n",
    "P_e \\approx \\left( \\frac{1}{10^3} \\right)^2 = 10^{-6}\n",
    "$\n",
    "\n",
    "### Summary\n",
    "- **Average SNR**: 1 (normalized)\n",
    "- **Rate**: 2 bpcu\n",
    "- **Diversity Gain**: 2\n",
    "- **Approximate Probability of Error at SNR = 30 dB**: $10^{-6}$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "88707e55-8e49-49ff-a0b9-cbf360243e0c",
   "metadata": {},
   "source": [
    "$11\\Bigl)$ ___(1 point)___. Consider the following distributed setup with N = 3 workers, as shown in Figure 1.\n",
    "There are $K = 3$ datasets, $W_1, W_2,$ and $W_3$, each of size 100 MBytes and each cache has a storage capacity of 200 MBytes.\n",
    "\n",
    "a) How does one need to distribute the datasets across the workers to ensure that the master node\n",
    "can recover all the datasets from any 2 workers?\n",
    "\n",
    "b) Assume that there is a delay constraint of 10 milli-seconds (ms) allowed for the master node to receive all the information. What is the total rate $R$ (in received bits per milli-second) with which the master node will be receiving data, in order for it to successfully recover $W_1, W_2, W_3$?\n",
    "\n",
    "c) Let us now assume that the master node also has memory and can cache one dataset. What is the total rate of transmission the master needs from the workers to successfully recover $W_1, W_2, W_3$?\n",
    "\n",
    "d) Comment on the role of memory on the transmission rate from the workers.\n",
    "\n",
    "![Descrption](images/Fig-01.png)\n"
   ]
  },
  {
   "cell_type": "raw",
   "id": "0cc9211a-9caa-4c84-93f7-35e72504cbd3",
   "metadata": {},
   "source": [
    "![Descrption](images/Fig-01.png)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95bec256-094e-4da8-bb94-fe25f0d7477f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "8faf8f8c-3d42-4b3d-9357-b012c60926c2",
   "metadata": {},
   "source": [
    "$12\\Bigl)$ ___(1 point)___. Name two applications that in your opinion popularized Reinforcement Learning in scientific communities working on Artificial Intelligence?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "31bc106d-e6c8-4dff-b789-5a2f6e96c407",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "347cfede-8c5f-40a4-bc24-275159ef527d",
   "metadata": {},
   "source": [
    "$13\\Bigl)$ ___(1 point)___. AlphaZero is one of the most exciting real-world applications that works using Reinforcement Learning. Name the two algorithms that are used by AlphaZero based on which this software achieves superior performance compared to humans."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25408e02-5971-46bd-8450-2eb47fd10b58",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "2fb81284-49d1-4ac2-bbc9-90c7a0521df4",
   "metadata": {},
   "source": [
    "$14\\Bigl)$ ___(1 point)___. Name two classes based on which one can distinguish exact dynamic programming algorithms?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3becb694-47e3-4181-b576-b3f65d190963",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "e605393e-979c-48f9-8034-7826974fa9c0",
   "metadata": {},
   "source": [
    "$15\\Bigl)$ ___(1 point)___. What is the difference between deterministic and stochastic dynamic programming algorithms?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e5c1e74-2668-40fc-89dc-8a6f167714e2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "a5dca395-6178-4a39-91d6-1ecf20031084",
   "metadata": {},
   "source": [
    "$16\\Bigl)$ ___(5 points)___. Quantum. The two components of the state$|\\theta⟩= \\frac{\\sqrt(3)}{2\\sqrt(2)}|11⟩+ \\frac{\\sqrt(5)}{2\\sqrt(2)}|00⟩$are shared amidst Alice and Bob. In other words, Alice has the first component and Bob has the second. Alice performs a measurement with two outcomes$\\{{+1,−1}\\}$. Outcome$+1$is associated with operator$|+⟩⟨+|$and Outcome$−1$is associated with$|−⟩⟨−|$. Bob performs a measurement with two outcomes$\\{{+1,−1}\\}$. Outcome$+1$is associated with operator$|0⟩⟨0|$and Outcome$−1$is associated with$|1⟩⟨1|$.\n",
    "\n",
    "a) Before the measurement is performed, is the joint state entangled or separable?\n",
    "\n",
    "b) Compute the probability of Alice observing $-1$ and Bob observing $+1$.\n",
    "\n",
    "c) Compute the probability of Alice and Bob BOTH observing $−1$.\n",
    "\n",
    "d) Compute the probability of Alice and Bob BOTH observing $+1$.\n",
    "\n",
    "e) Identify the post measurement state when Alice observes $+1$ and Bob observes $−1$."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "37008db7-ab3b-46b2-a040-af602c3e2112",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Julia 1.11.1",
   "language": "julia",
   "name": "julia-1.11"
  },
  "language_info": {
   "file_extension": ".jl",
   "mimetype": "application/julia",
   "name": "julia",
   "version": "1.11.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
